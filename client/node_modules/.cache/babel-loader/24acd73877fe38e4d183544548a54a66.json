{"ast":null,"code":"var _jsxFileName = \"/Users/filip.cordas/Documents/Projects/web-api-auth-examples/client/src/components/TopList.js\";\n\n/* eslint-disable no-unused-vars */\nimport React, { useState, useContext } from 'react';\nimport Spotify from 'spotify-web-api-js';\nimport { ContextUser } from '../components/UserContext';\nconst spotifyWebApi = new Spotify();\n\nconst TopList = () => {\n  const {\n    user,\n    setUser\n  } = useContext(ContextUser);\n  const [topTracks, setTopTracks] = useState([]);\n  const [isPlaying, setPlaying] = useState([]);\n  const [error, setError] = useState([]);\n\n  function getTopList(period) {\n    spotifyWebApi.setAccessToken(user.token);\n    spotifyWebApi.getMyTopTracks({\n      limit: 30,\n      time_range: period\n    }).then(res => {\n      console.log(res);\n      setTopTracks(Object.values(res)[0]);\n    });\n  }\n\n  function playSong(e) {\n    const audio = e.target.nextSibling.nextSibling;\n    audio.volume = 0.1;\n\n    if (audio.paused) {\n      audio.play();\n      setPlaying(audio);\n    } else {\n      audio.pause();\n      setPlaying([]);\n    }\n  }\n\n  function addToPlayList() {\n    const tracks = topTracks.map(track => track.uri);\n    spotifyWebApi.createPlaylist(user.id, {\n      name: 'Your Top Tracks',\n      public: true,\n      collaborative: false,\n      description: 'Your most listened to songs.'\n    }, (err, res) => {\n      if (err) return setError(err);\n      if (res.id) spotifyWebApi.addTracksToPlaylist(res.id, tracks);\n    });\n  }\n\n  const disableButton = e => {\n    const buttons = document.getElementsByClassName('TopList__buttons--button');\n\n    for (let i = 0; i < buttons.length; i++) buttons[i].disabled = false;\n\n    e.target.disabled = true;\n  };\n\n  const renderDynamicButtons = period => user.token && /*#__PURE__*/React.createElement(\"button\", {\n    id: period,\n    className: \"TopList__buttons--button\",\n    onClick: e => {\n      getTopList(period);\n      disableButton(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 4\n    }\n  }, period.replace(period[0], period[0].toUpperCase()).replace('_', ' '));\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"TopList\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"TopList__title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 4\n    }\n  }, \"Your Top Tracks\"), !user.token && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 5\n    }\n  }, \"Please log in to use this functionality.\"), /*#__PURE__*/React.createElement(\"section\", {\n    className: \"TopList__buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 4\n    }\n  }, renderDynamicButtons('long_term'), renderDynamicButtons('medium_term'), renderDynamicButtons('short_term')), topTracks.length > 0 && /*#__PURE__*/React.createElement(\"button\", {\n    onClick: addToPlayList,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 5\n    }\n  }, \"Create playlist\"), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"TopList__list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 4\n    }\n  }, topTracks && topTracks.map((item, index) => /*#__PURE__*/React.createElement(\"article\", {\n    key: item.name + item.id,\n    className: \"TopList__song--wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }, item.preview_url !== null && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"TopList__playpause--wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: `playpause ${item.name}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onClick: e => playSong(e),\n    type: \"checkbox\",\n    defaultChecked: true,\n    value: \"None\",\n    id: `playpause ${item.name}`,\n    name: \"check\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 10\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: `playpause ${item.name}`,\n    tabIndex: \"1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 10\n    }\n  }), /*#__PURE__*/React.createElement(\"audio\", {\n    loop: true,\n    volume: \"0.1\",\n    className: `audio_${item.name}`,\n    key: `playback ${item.name}`,\n    src: item.preview_url,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 10\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"TopList__content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    key: item.name,\n    className: \"TopList__song\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, `${index + 1} - ${item.artists[0].name} - ${item.name}`)), /*#__PURE__*/React.createElement(\"img\", {\n    className: \"TopList__image\",\n    src: item.album.images[1].url,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 8\n    }\n  })))));\n};\n\nexport default TopList;","map":{"version":3,"sources":["/Users/filip.cordas/Documents/Projects/web-api-auth-examples/client/src/components/TopList.js"],"names":["React","useState","useContext","Spotify","ContextUser","spotifyWebApi","TopList","user","setUser","topTracks","setTopTracks","isPlaying","setPlaying","error","setError","getTopList","period","setAccessToken","token","getMyTopTracks","limit","time_range","then","res","console","log","Object","values","playSong","e","audio","target","nextSibling","volume","paused","play","pause","addToPlayList","tracks","map","track","uri","createPlaylist","id","name","public","collaborative","description","err","addTracksToPlaylist","disableButton","buttons","document","getElementsByClassName","i","length","disabled","renderDynamicButtons","replace","toUpperCase","item","index","preview_url","artists","album","images","url"],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-vars */\nimport React, { useState, useContext } from 'react';\nimport Spotify from 'spotify-web-api-js';\nimport { ContextUser } from '../components/UserContext';\n\nconst spotifyWebApi = new Spotify();\n\nconst TopList = () => {\n\tconst { user, setUser } = useContext(ContextUser);\n\tconst [topTracks, setTopTracks] = useState([]);\n\tconst [isPlaying, setPlaying] = useState([]);\n\tconst [error, setError] = useState([]);\n\n\tfunction getTopList(period) {\n\t\tspotifyWebApi.setAccessToken(user.token);\n\t\tspotifyWebApi.getMyTopTracks({limit: 30, time_range: period }).then(res => {\n\t\t\tconsole.log(res);\n\t\t\tsetTopTracks(Object.values(res)[0]);\n\t\t});\n\t}\n\n\tfunction playSong(e) {\n\t\tconst audio = e.target.nextSibling.nextSibling;\n\t\taudio.volume = 0.1;\n\t\tif (audio.paused) {\n\t\t\taudio.play();\n\t\t\tsetPlaying(audio);\n\t\t} else {\n\t\t\taudio.pause();\n\t\t\tsetPlaying([]);\n\t\t}\n\t}\n\n\tfunction addToPlayList() {\n\t\tconst tracks = topTracks.map(track => track.uri);\n\t\tspotifyWebApi.createPlaylist(\n\t\t\tuser.id,\n\t\t\t{\n\t\t\t\tname: 'Your Top Tracks',\n\t\t\t\tpublic: true,\n\t\t\t\tcollaborative: false,\n\t\t\t\tdescription: 'Your most listened to songs.',\n\t\t\t},\n\t\t\t(err, res) => {\n\t\t\t\tif (err) return setError(err);\n\t\t\t\tif (res.id) spotifyWebApi.addTracksToPlaylist(res.id, tracks);\n\t\t\t}\n\t\t);\n\t}\n\n\tconst disableButton = e => {\n\t\tconst buttons = document.getElementsByClassName('TopList__buttons--button');\n\t\tfor (let i = 0; i < buttons.length; i++) buttons[i].disabled = false;\n\t\te.target.disabled = true;\n\t};\n\n\tconst renderDynamicButtons = period =>\n\t\tuser.token && (\n\t\t\t<button\n\t\t\t\tid={period}\n\t\t\t\tclassName='TopList__buttons--button'\n\t\t\t\tonClick={e => {\n\t\t\t\t\tgetTopList(period);\n\t\t\t\t\tdisableButton(e);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{(period.replace(period[0], period[0].toUpperCase()).replace('_', ' '))}\n\t\t\t</button>\n\t\t);\n\n\treturn (\n\t\t<div className='TopList'>\n\t\t\t<h1 className='TopList__title'>Your Top Tracks</h1>\n\n\t\t\t{!user.token && (\n\t\t\t\t<p className='message'>Please log in to use this functionality.</p>\n\t\t\t)}\n\t\t\t<section className='TopList__buttons'>\n\t\t\t\t{renderDynamicButtons('long_term')}\n\t\t\t\t{renderDynamicButtons('medium_term')}\n\t\t\t\t{renderDynamicButtons('short_term')}\n\t\t\t</section>\n\t\t\t{topTracks.length > 0 && (\n\t\t\t\t<button onClick={addToPlayList}>Create playlist</button>\n\t\t\t)}\n\n\t\t\t<ul className='TopList__list'>\n\t\t\t\t{topTracks &&\n\t\t\t\t\ttopTracks.map((item, index) => (\n\t\t\t\t\t\t<article key={item.name + item.id} className='TopList__song--wrapper'>\n            {item.preview_url !== null &&\n\t\t\t\t\t\t\t<div className='TopList__playpause--wrapper'>\n\t\t\t\t\t\t\t\t<div className={`playpause ${item.name}`}>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tonClick={e => playSong(e)}\n\t\t\t\t\t\t\t\t\t\ttype='checkbox'\n\t\t\t\t\t\t\t\t\t\tdefaultChecked={true}\n\t\t\t\t\t\t\t\t\t\tvalue='None'\n\t\t\t\t\t\t\t\t\t\tid={`playpause ${item.name}`}\n\t\t\t\t\t\t\t\t\t\tname='check'\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\t\t\thtmlFor={`playpause ${item.name}`}\n\t\t\t\t\t\t\t\t\t\ttabIndex='1'\n\t\t\t\t\t\t\t\t\t></label>\n\t\t\t\t\t\t\t\t\t<audio\n\t\t\t\t\t\t\t\t\t\tloop\n\t\t\t\t\t\t\t\t\t\tvolume='0.1'\n\t\t\t\t\t\t\t\t\t\tclassName={`audio_${item.name}`}\n\t\t\t\t\t\t\t\t\t\tkey={`playback ${item.name}`}\n\t\t\t\t\t\t\t\t\t\tsrc={item.preview_url}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>}\n\t\t\t\t\t\t\t<div className='TopList__content'>\n\t\t\t\t\t\t\t\t<li key={item.name} className='TopList__song'>{`${\n\t\t\t\t\t\t\t\t\tindex + 1\n\t\t\t\t\t\t\t\t} - ${item.artists[0].name} - ${item.name}`}</li>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tclassName='TopList__image'\n\t\t\t\t\t\t\t\tsrc={item.album.images[1].url}\n\t\t\t\t\t\t\t></img>\n\t\t\t\t\t\t</article>\n\t\t\t\t\t))}\n\t\t\t</ul>\n\t\t</div>\n\t);\n};\n\nexport default TopList;\n"]},"metadata":{},"sourceType":"module"}